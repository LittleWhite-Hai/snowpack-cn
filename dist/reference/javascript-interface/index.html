<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"><link rel="manifest" href="/favicon/site.webmanifest"><title>JavaScript API</title><meta name="title" content="JavaScript API"><meta name="description" content="Snowpack's JavaScript API is for anyone who wants to integrate with some custom build pipeline or server-side rendering engine."><meta property="og:type" content="website"><meta property="og:url" content="TODO"><meta property="og:title" content="JavaScript API"><meta property="og:description" content="Snowpack's JavaScript API is for anyone who wants to integrate with some custom build pipeline or server-side rendering engine."><meta property="og:image" content="https://www.snowpack.dev/img/social-2.jpg"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="TODO"><meta property="twitter:title" content="JavaScript API"><meta property="twitter:description" content="Snowpack's JavaScript API is for anyone who wants to integrate with some custom build pipeline or server-side rendering engine."><meta property="twitter:image" content="https://www.snowpack.dev/img/social-2.jpg"><link rel="stylesheet" href="/_astro/common-ZjJAJL.css" type="text/css"><link href="https://fonts.googleapis.com/css2?family=Overpass:wght@400;700;900&amp;display=swap" rel="stylesheet"><style type="text/css">
.layout.astro-Ju9h9Rf8 {
  display: grid;
  grid-template-areas: "contents" "main";
  grid-gap: 2rem;
}
@media (min-width: 800px) {
  .layout.astro-Ju9h9Rf8 {
    grid-template-areas: "nav contents" "nav main";
  }
}
@media (min-width: 1240px) {
  .layout.astro-Ju9h9Rf8 {
    grid-template-areas: "nav main contents";
    grid-template-columns: 16rem auto 20rem;
  }
}
.layout-nav.astro-Ju9h9Rf8 {
  grid-area: nav;
}
@media (min-width: 800px) {
  .layout-nav.astro-Ju9h9Rf8 {
    position: -webkit-sticky;
    position: sticky;
    min-height: calc(100vh - 3.5rem);
    height: calc(100vh - 3.5rem);
    top: 3.5rem;
  }
}
.layout-main.astro-Ju9h9Rf8 {
  grid-area: main;
  min-width: 0;
  padding: 24px 0 24px 0;
}
@media (min-width: 1240px) {
  .layout-contents.astro-Ju9h9Rf8 {
    position: -webkit-sticky;
    position: sticky;
    min-height: calc(100vh - 3.5rem);
    height: calc(100vh - 3.5rem);
    top: 3.5rem;
  }
}

h3 {
  position: relative;
}

.header-link {
  position: absolute;
  top: 0;
  right: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  font-weight: 400;
  font-size: 0.75em;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  color: #c1c1c1;
  opacity: 0;
  transition: opacity 100ms linear, color 100ms linear;
}

.header-link:hover {
  color: #267dd6;
}

h3:hover .header-link {
  opacity: 1;
}</style></head><body><nav class="nav astro-ahFEmudE"><button id="toc-drawer-button" class="mobile-open astro-ahFEmudE" type="button" aria-expanded="false" aria-controls="nav-primary"><svg focusable="false" class="hamburger astro-ahFEmudE" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><title>Toggle mobile menu</title><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" class="astro-ahFEmudE"></path></svg></button><a class="logo astro-ahFEmudE" href="/"><svg class="logo-icon astro-ahFEmudE" viewBox="0 0 640 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g transform="translate(-1.000000, 0.000000)" fill-rule="nonzero" class="astro-ahFEmudE"><path d="M635.92,462.7 L347.92,14.7 C342.03,5.54 331.89,0 321,0 C310.11,0 299.97,5.54 294.08,14.7 L6.08,462.7 C-0.250773249,472.547007 -0.699487627,485.064987 4.91,495.34 C10.522069,505.612419 21.2945349,512 33,512 L609,512 C620.71,512 631.48,505.61 637.09,495.33 C642.699457,485.058495 642.250708,472.543372 635.92,462.7 Z M321,91.18 L406.39,224 L321,224 L257,288 L218.94,249.94 L321,91.18 Z" id="Shape" class="astro-ahFEmudE"></path></g></svg><span class="logo-type astro-ahFEmudE">Snowpack</span></a><div class="search astro-ahFEmudE"><input type="text" name="search" placeholder="在文档中搜索..." class="search-input astro-ahFEmudE" id="search-form-input"><span class="search-hint astro-ahFEmudE"><span class="sr-only astro-ahFEmudE">Press </span><kbd class="font-sans astro-ahFEmudE"><abbr title="Command" style="text-decoration: none;" class="astro-ahFEmudE">⌘</abbr></kbd><span class="sr-only astro-ahFEmudE"> and </span><kbd class="font-sans astro-ahFEmudE">K</kbd><span class="sr-only astro-ahFEmudE"> to search</span></span></div><a href="https://github.com/snowpackjs/snowpack/releases" target="_blank" class="link version astro-ahFEmudE">
    v3.8.8
  </a><a href="https://github.com/withastro/snowpack" target="_blank" class="link link__desktop astro-ahFEmudE"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="social astro-ahFEmudE" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" class="astro-ahFEmudE"></path></svg></a><a href="https://twitter.com/snowpackjs" target="_blank" class="link link__desktop astro-ahFEmudE"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="social astro-ahFEmudE" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" class="astro-ahFEmudE"></path></svg></a><a href="https://discord.gg/snowpack" target="_blank" class="link link__desktop astro-ahFEmudE"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="discord" class="social astro-ahFEmudE" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 210 240"><path d="M84.79 90.45c-6.45 0-11.55 5.66-11.55 12.57s5.21 12.57 11.55 12.57c6.45 0 11.55-5.66 11.55-12.57.11-6.91-5.09-12.57-11.55-12.57zm41.32 0c-6.45 0-11.55 5.66-11.55 12.57s5.21 12.57 11.55 12.57c6.45 0 11.55-5.66 11.55-12.57s-5.09-12.57-11.55-12.57z" class="astro-ahFEmudE"></path><path fill="currentColor" d="M185.4 0H24.6C11.04 0 0 11.04 0 24.72v162.24c0 13.68 11.04 24.72 24.6 24.72h136.08l-6.36-22.2 15.36 14.28 14.52 13.44L210 240V24.72C210 11.04 198.96 0 185.4 0zm-46.32 156.72s-4.32-5.16-7.92-9.72c15.72-4.44 21.72-14.28 21.72-14.28-4.92 3.24-9.6 5.52-13.8 7.08-6 2.52-11.76 4.2-17.4 5.16-11.52 2.16-22.08 1.56-31.08-.12-6.84-1.32-12.72-3.24-17.64-5.16-2.76-1.08-5.76-2.4-8.76-4.08-.36-.24-.72-.36-1.08-.6-.24-.12-.36-.24-.48-.36-2.16-1.2-3.36-2.04-3.36-2.04s5.76 9.6 21 14.16c-3.6 4.56-8.04 9.96-8.04 9.96-26.52-.84-36.6-18.24-36.6-18.24 0-38.64 17.28-69.96 17.28-69.96 17.28-12.96 33.72-12.6 33.72-12.6l1.2 1.44c-21.6 6.24-31.56 15.72-31.56 15.72s2.64-1.44 7.08-3.48c12.84-5.64 23.04-7.2 27.24-7.56.72-.12 1.32-.24 2.04-.24 7.32-.96 15.6-1.2 24.24-.24 11.4 1.32 23.64 4.68 36.12 11.52 0 0-9.48-9-29.88-15.24l1.68-1.92s16.44-.36 33.72 12.6c0 0 17.28 31.32 17.28 69.96 0 0-10.2 17.4-36.72 18.24z" class="astro-ahFEmudE"></path></svg></a></nav><script>
  function handleMobileNav(evt) {
    evt.preventDefault();
    /*If hidden-mobile class is enabled that means we are on desktop do overflow normal but we
      if we are at mobile fixed body position, so that its not scrollable(which currently causing bug) and navbar  handling its
      owns scroll. Case to consider there are chance use can open navbar using toggle button and user when click on any link
      body postion should be unset
      */
    document.body.classList.toggle('is-nav-open');
    const isOpen = document.body.classList.contains('is-nav-open');
    if (isOpen) {
      evt.target.setAttribute('aria-expanded', 'true');
    } else {
      evt.target.setAttribute('aria-expanded', 'false');
    }
  }

  const mobileNavBtn = document.getElementById('toc-drawer-button');
  mobileNavBtn.addEventListener('click', handleMobileNav);
  mobileNavBtn.addEventListener('touchend', handleMobileNav);
  if (window.location.pathname.startsWith('/posts')) {
    mobileNavBtn.style.display = 'none';
  }

  const searchFormInputEl = document.getElementById('search-form-input');
  searchFormInputEl.addEventListener('keyup', () => {
    const gridTocEl = document.querySelector('#nav-primary');
    if (searchFormInputEl.value) {
      gridTocEl.classList.add('is-mobile-hidden');
    } else {
      gridTocEl.classList.remove('is-mobile-hidden');
    }
  });

  document.onkeydown = function (e) {
    if ((e.ctrlKey || e.metaKey) && e.which == 75) {
      e.preventDefault();
      searchFormInputEl.focus();
    }
  };
</script><script type="module" src="/_astro/src/components/docsearch.js"></script><doc-search api-key="562139304880b94536fc53f5d65c5c19" selector="#search-form-input" class="astro-ahFEmudE"></doc-search><div class="wrapper astro-Ju9h9Rf8"><section class="layout astro-Ju9h9Rf8"><aside id="nav-primary" class="layout-nav astro-Ju9h9Rf8"><nav class="nav astro-hk9uDi21"><ol class="contents astro-hk9uDi21"><li class="section astro-hk9uDi21"><span class="header astro-hk9uDi21">概念</span><ol class="items astro-hk9uDi21"><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/concepts/how-snowpack-works">Snowpack运行机制</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/concepts/dev-server">开发时服务</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/concepts/build-pipeline">打包流程</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/concepts/hot-module-replacement">模块热替换(HMR)</a></li></ol></li><li class="section astro-hk9uDi21"><span class="header astro-hk9uDi21">开始</span><ol class="items astro-hk9uDi21"><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/tutorials/quick-start">快速上手</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/tutorials/getting-started">正式使用</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/tutorials/react">React</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/tutorials/svelte">Svelte</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/tutorials/vue">Vue</a></li></ol></li><li class="section astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/guides"><span class="header astro-hk9uDi21">指南</span></a></li><li class="section astro-hk9uDi21"><span class="header astro-hk9uDi21">引用</span><ol class="items astro-hk9uDi21"><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/configuration">snowpack.config.js</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/cli-command-line-interface">命令行 API</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/javascript-interface">JavaScript API</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/plugins">插件 API</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/environment-variables">环境变量</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/hot-module-replacement">模块热替换 API</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/supported-files">支持的文件类型</a></li><li class="astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/reference/common-error-details">常见错误</a></li></ol></li><li class="section astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/plugins"><span class="header astro-hk9uDi21">插件目录</span></a></li><li class="section astro-hk9uDi21"><a class="link astro-hk9uDi21" href="/news"><span class="header astro-hk9uDi21">社区 &amp; 新闻</span></a></li></ol></nav></aside><div class="astro-Ju9h9Rf8"><script type="module" defer="" src="/js/index.js"></script><aside class="subnav astro-6RrcgMjt"><div class="astro-6RrcgMjt"><h4 class="header astro-6RrcgMjt">小节</h4><nav class="toc astro-6RrcgMjt"><ol class="astro-6RrcgMjt"><li class="astro-6RrcgMjt"><a href="#createconfiguration" class="astro-6RrcgMjt">createConfiguration()</a></li><li class="astro-6RrcgMjt"><a href="#loadconfiguration" class="astro-6RrcgMjt">loadConfiguration()</a></li><li class="astro-6RrcgMjt"><a href="#startserver" class="astro-6RrcgMjt">startServer()</a></li><li class="astro-6RrcgMjt"><a href="#snowpack-开发服务器snowpackdevserver" class="astro-6RrcgMjt">Snowpack 开发服务器(SnowpackDevServer)</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevserverport" class="astro-6RrcgMjt">SnowpackDevServer.port</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevserverloadurl" class="astro-6RrcgMjt">SnowpackDevServer.loadUrl()</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevservergeturlforfile" class="astro-6RrcgMjt">SnowpackDevServer.getUrlForFile()</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevservergeturlforpackage" class="astro-6RrcgMjt">SnowpackDevServer.getUrlForPackage()</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevserversendresponseerror" class="astro-6RrcgMjt">SnowpackDevServer.sendResponseError()</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevserveronfilechange" class="astro-6RrcgMjt">SnowpackDevServer.onFileChange()</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevservershutdown" class="astro-6RrcgMjt">SnowpackDevServer.shutdown()</a></li><li class="astro-6RrcgMjt"><a href="#snowpackdevservergetserverruntime" class="astro-6RrcgMjt">SnowpackDevServer.getServerRuntime()</a></li><li class="astro-6RrcgMjt"><a href="#服务器运行时间serverruntime" class="astro-6RrcgMjt">服务器运行时间（ServerRuntime）</a></li><li class="astro-6RrcgMjt"><a href="#服务器运行时模块serverruntimemodule" class="astro-6RrcgMjt">服务器运行时模块（ServerRuntimeModule）</a></li><li class="astro-6RrcgMjt"><a href="#build" class="astro-6RrcgMjt">build()</a></li><li class="astro-6RrcgMjt"><a href="#snowpackbuildresultresult" class="astro-6RrcgMjt">SnowpackBuildResult.result</a></li><li class="astro-6RrcgMjt"><a href="#snowpackbuildresultshutdown" class="astro-6RrcgMjt">SnowpackBuildResult.shutdown</a></li><li class="astro-6RrcgMjt"><a href="#snowpackbuildresultonfilechange" class="astro-6RrcgMjt">SnowpackBuildResult.onFileChange</a></li><li class="astro-6RrcgMjt"><a href="#geturlforfile" class="astro-6RrcgMjt">getUrlForFile()</a></li><li class="astro-6RrcgMjt"><a href="#clearcache" class="astro-6RrcgMjt">clearCache()</a></li><li class="astro-6RrcgMjt"><a href="#logger" class="astro-6RrcgMjt">logger</a></li></ol></nav><hr class="astro-6RrcgMjt"></div><h4 class="header astro-6RrcgMjt">提供建议</h4><a href="https://github.com/snowpackjs/snowpack/blob/main/docs" class="astro-6RrcgMjt">在GitHub上编辑这篇文章</a><div style="height:550px" class="astro-6RrcgMjt"></div><a href="https://beian.miit.gov.cn" style="color:rgb(58,93,127); font-size:15px; line-height: 5; display: inline-flex;" class="astro-6RrcgMjt">
  京ICP备2021037274号-1
</a></aside></div><article class="layout-main astro-Ju9h9Rf8"><div class="content astro-Ju9h9Rf8"><h2 class="content-title astro-Ju9h9Rf8">JavaScript API</h2><div class="content-layout astro-Ju9h9Rf8"><div class="content-body astro-Ju9h9Rf8"><p>大多数用户将通过<a href="/reference/cli-command-line-interface">命令行</a>界面（CLI）与 Snowpack 互动。然而，Snowpack 也提供了一个 JavaScript API，供任何人在此基础上 build。</p><p>本页包含了关于 Snowpack 的公共 API 和所有相关数据类型的参考信息。在项目中定义的所有数据类型（公共和私有）的完整集合可以在包的<a href="https://unpkg.com/browse/snowpack@3.0.10/lib/types.d.ts"><code>types.d.ts</code></a> 文件中找到。</p><h3 id="createconfiguration">createConfiguration()</h3><p><code>createConfiguration(config?: SnowpackUserConfig) =&gt; SnowpackConfig</code></p><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>createConfiguration<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'snowpack'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">createConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>几乎所有 Snowpack 做的事情都需要一个配置对象。Snowpack 被设计成可以在零配置的情况下运行，这个函数接受的<code>config</code>参数可以是完整的、空的，或者只包含几个属性。配置对象的其余部分将被填入 Snowpack 通常的一组默认值，在我们的<a href="/reference/configuration">snowpack.config.mjs 文档</a>中有介绍。</p><p>最简单的方法是，<code>SnowpackUserConfig</code>是外部记录的配置格式，而<code>SnowpackConfig</code>是我们的内部表示，所有可选/未定义的值都是用实际的默认值填充的。</p><h3 id="loadconfiguration">loadConfiguration()</h3><p><code>loadConfiguration(overrides?: SnowpackUserConfig, configPath?: string | undefined) =&gt; Promise.</code></p><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>loadConfiguration<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'snowpack'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'/path/to/snowpack.config.mjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>类似于<code>createConfiguration</code>，但这个函数实际上将检查文件系统，从磁盘上加载一个配置文件。</p><p>该配置文件中的所有路径都是相对于文件本身的。</p><h3 id="startserver">startServer()</h3><p><code>startServer({config: SnowpackUserConfig}) =&gt; Promise.</code></p><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>startServer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'snowpack'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">createConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>config<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns: SnowpackDevServer</span>
</code></pre><p>启动一个新的 Snowpack 开发服务器实例。这相当于在命令行上运行<code>snowpack dev</code>。</p><p>一旦启动，你可以从开发服务器上加载文件，Snowpack 将按照要求构建它们。这是一个需要理解的重要功能。Snowpack 的开发服务器在启动时不做任何文件构建，而是在通过服务器的<code>loadUrl</code>方法请求时才构建文件。</p><h3 id="snowpack-开发服务器snowpackdevserver">Snowpack 开发服务器(SnowpackDevServer)</h3><h4 id="snowpackdevserverport">SnowpackDevServer.port</h4><p>服务器监听的端口。</p><h4 id="snowpackdevserverloadurl">SnowpackDevServer.loadUrl()</h4><p><code>loadUrl(reqUrl: string, opt?:{isSSR? : boolean; allowStale? : boolean; encoding? : string}）。)Promise&gt;。</code></p><pre class=" language-ts"><code class="language-ts"><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>config<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>contents<span class="token punctuation">}</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span><span class="token string">'/dist/index.js'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>加载一个文件并返回结果。在第一次请求一个 URL 的时候，这将启动一个构建，然后在服务器的生命周期内为所有未来的请求进行缓存。</p><p>你可以通过<code>allowStale: true</code>来启用 Snowpack 的冷缓存，以获得过去会话的缓存结果。然而，Snowpack 对冷缓存数据是否是最新的不提供任何保证。</p><h4 id="snowpackdevservergeturlforfile">SnowpackDevServer.getUrlForFile()</h4><p><code>getUrlForFile(fileLoc: string) =&gt; string | null;</code></p><pre class=" language-ts"><code class="language-ts"><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>config<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fileUrl <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">getUrlForFile</span><span class="token punctuation">(</span><span class="token string">'/path/to/index.jsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>contents<span class="token punctuation">}</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span>fileUrl<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>一个辅助函数，用于查找任何源文件的最终托管 URL。与<code>loadUrl</code>结合使用时非常有用，因为你可能只知道一个文件在磁盘上的位置而不知道它的最终托管 URL。</p><h4 id="snowpackdevservergeturlforpackage">SnowpackDevServer.getUrlForPackage()</h4><p><code>getUrlForPackage(packageSpec: string) =&gt; Promise[string]。</code></p><pre class=" language-ts"><code class="language-ts"><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> config <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> pkgUrl <span class="token operator">=</span> <span class="token keyword">await</span> server<span class="token punctuation">.</span><span class="token function">getUrlForPackage</span><span class="token punctuation">(</span><span class="token string">"preact"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>一个用于查找任何依赖关系的最终托管 URL 的辅助函数。</p><h4 id="snowpackdevserversendresponseerror">SnowpackDevServer.sendResponseError()</h4><p><code>sendResponseError(req: http.IncomingMessage, res: http.ServerResponse, status: number) =&gt; void;</code></p><p>一个辅助函数，用于在服务器响应处理程序中发送一个错误响应。在将 Snowpack 与 Express、Koa 或任何其他 Node.js 服务器集成时非常有用。</p><h4 id="snowpackdevserveronfilechange">SnowpackDevServer.onFileChange()</h4><p><code>onFileChange({filePath: string}) =&gt; void;</code></p><p>监听文件的变化事件。在你可能想自己观察文件系统变化的情况下很有用，并且可以通过挂载我们已经运行的观察器来节省开销/性能。</p><h4 id="snowpackdevservershutdown">SnowpackDevServer.shutdown()</h4><p><code>shutdown() =&gt; Promise;</code></p><pre class=" language-ts"><code class="language-ts"><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> config <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> server<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>关闭 Snowpack 开发服务器。清理任何长期运行的命令、文件观察器等。</p><h4 id="snowpackdevservergetserverruntime">SnowpackDevServer.getServerRuntime()</h4><p><code>getServerRuntime({invalidateOnChange?: boolean}) =&gt; ServerRuntime;</code></p><pre class=" language-ts"><code class="language-ts"><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">startServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> config <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> runtime <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">getServerRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> helloWorld <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> runtime<span class="token punctuation">.</span><span class="token function">importModule</span><span class="token punctuation">(</span><span class="token string">"/dist/index.js"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token function">helloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>返回一个 ESM 服务器运行时间，让 Node.js 直接从 Snowpack 的构建缓存中导入模块。这对 SSR、测试运行前端代码以及构建管道的整体统一很有用。</p><p>欲了解更多信息，请查看我们关于使用<code>getServerRuntime()</code>API 的<a href="/guides/server-side-render">服务器端渲染</a>的指南。</p><h4 id="服务器运行时间serverruntime">服务器运行时间（ServerRuntime）</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">ServerRuntime</span> <span class="token punctuation">{</span>
  <span class="token comment">/** Import a Snowpack-build JavaScript file into Node.js. */</span>
  <span class="token function">importModule</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ServerRuntimeModule<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">/** Invalidate a module in the internal runtime cache. */</span>
  <span class="token function">invalidateModule</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="服务器运行时模块serverruntimemodule">服务器运行时模块（ServerRuntimeModule）</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">ServerRuntimeModule</span> <span class="token punctuation">{</span>
  <span class="token comment">/** The imported module. */</span>
  exports<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token comment">/** References to all internal CSS imports. Useful for CSS extraction. */</span>
  css<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="build">build()</h3><p><code>build({config: SnowpackUserConfig}) =&gt; Promise[SnowpackBuildResult</code></p><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>build<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'snowpack'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">createConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>result<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span>config<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns: SnowpackBuildResult</span>
</code></pre><h4 id="snowpackbuildresultresult">SnowpackBuildResult.result</h4><p>一个所有构建输入和输出文件的内存清单。</p><h4 id="snowpackbuildresultshutdown">SnowpackBuildResult.shutdown</h4><p>在<code>-watch</code>模式下，<code>build()</code>函数将被解析，但构建本身将继续。使用此函数来关闭构建观察器。</p><p>在正常的构建模式下（非观察模式），该函数将抛出一个警告。</p><h4 id="snowpackbuildresultonfilechange">SnowpackBuildResult.onFileChange</h4><p>在<code>-watch</code>模式下，<code>build()</code>函数将被解析，但构建本身将继续。使用这个函数来响应文件变化事件，而不需要启动你自己的文件观察程序。</p><p>在正常的构建模式下（非监视模式），该函数将抛出一个警告。</p><h3 id="geturlforfile">getUrlForFile()</h3><p><code>getUrlForFile(fileLoc: string, config: SnowpackConfig) =&gt; string | null</code></p><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> getUrlForFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"snowpack"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fileUrl <span class="token operator">=</span> <span class="token function">getUrlForFile</span><span class="token punctuation">(</span><span class="token string">"/path/to/file.js"</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>一个辅助函数，用于查找任何源文件的最终托管 URL。与<code>loadUrl</code>结合使用时非常有用，因为你可能只知道一个文件在磁盘上的位置而不知道它的最终托管 URL。</p><p>类似于<code>SnowpackDevServer.getUrlForFile()</code>，但需要第二个<code>config</code>参数来告知结果。</p><h3 id="clearcache">clearCache()</h3><p><code>clearCache() =&gt; Promise[void].</code></p><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> clearCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"snowpack"</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>相当于使用<code>snowpack</code>CLI 的<code>--reload</code>标志。清除 Snowpack 中的所有缓存数据。对于故障排除很有用，或者在做了一些 Snowpack 无法检测到的改变之后，清除缓存。</p><h3 id="logger">logger</h3><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> logger <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"snowpack"</span><span class="token punctuation">;</span>
</code></pre><p>你可以通过导入 Snowpack 的内部日志器来直接控制它。请注意，这是一个高级功能，对于大多数用户来说并不需要。相反，使用<code>verbose</code>配置选项来启用调试日志和控制日志信息的冗长性。</p></div></div></div></article></section></div><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-130280175-9"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());
  gtag('config', 'UA-130280175-9', { page_path: location.pathname === '/' ? (location.pathname + location.hash) : (location.pathname) });
</script></body></html>